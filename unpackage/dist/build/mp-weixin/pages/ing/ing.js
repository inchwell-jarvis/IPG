(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/ing/ing"],{"16d0":function(t,e,o){},"3f78":function(t,e,o){"use strict";o.r(e);var n=o("b535"),i=o.n(n);for(var a in n)"default"!==a&&function(t){o.d(e,t,(function(){return n[t]}))}(a);e["default"]=i.a},"428d":function(t,e,o){"use strict";var n=o("16d0"),i=o.n(n);i.a},"4a1c":function(t,e,o){"use strict";o.r(e);var n=o("b88e"),i=o("3f78");for(var a in i)"default"!==a&&function(t){o.d(e,t,(function(){return i[t]}))}(a);o("428d");var s,u=o("f0c5"),l=Object(u["a"])(i["default"],n["b"],n["c"],!1,null,"02e8270a",null,!1,n["a"],s);e["default"]=l.exports},b535:function(t,e,o){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o("c03e"),i={data:function(){return{DelImgshow:!1,DelImgContent:"是否删除此图片?",delimgid:"",checked:!1,show:!1,numberPlate:"",address:"",automatic_manual:!0,JCData:{},indexState:0,ZuoBiao:"",value:"",BestMileage:" - - ",UpdateMileage:"",UpdateReason:"",radioList:[{name:"到达途中/酒店",disabled:!1},{name:"到达家/公司",disabled:!1},{name:"到达客户现场",disabled:!1}],radio:"到达途中/酒店",CompleteList:[{name:"未完成任务",disabled:!1},{name:"已完成任务",disabled:!1}],CompleteState:"未完成任务",action:"http://www.example.com/upload",ImgBase64List:[],UpimageLength:0,loadingState:!1,SaveMemo:"",get_angle_similarity:0,modal_show:!1,modal_content:"",UpdateSRCState_LIlS37:0,botView_show:!1,botView_content:"",botView_index:0}},onShow:function(){this.GetSRClocks(),this.getLocation()},methods:{checkPrice:function(t){-1!=t.indexOf(".")&&this.$refs.uTips.show({title:"修改里程禁止输入小数点，请修改",type:"warning",duration:"2300"})},UpdateSRCStateInit:function(t){this.UpdateSRCState_LIlS37=t,this.modal_content=5==t?"是否暂停此工单？":"是否结束此工单？",this.modal_show=!0},UpdateSRCState:function(){var t=this;this.modal_show=!1;var e={url:"SRClock/UpdateSRCState",method:"post",data:{SRCId:this.JCData.SRCId,State:this.UpdateSRCState_LIlS37}};this.$http(e).then((function(e){console.log(e.Data),t.$refs.uTips.show({title:5==t.UpdateSRCState_LIlS37?"已暂停":"已结束",type:"success",duration:"2300"}),t.Fun()})).catch((function(t){console.log(t)}))},Fun:function(){t.switchTab({url:"/pages/home/home"})},DepartureAndArrival:function(t){this.botView_show=!0,this.botView_content=1==t?"出发此工单？":"到达此工单？",this.botView_index=t},FunChoosing:function(){1==this.botView_index?this.OpenSRClock():this.reach()},OpenSRClock:function(){var t=this;if(this.JCData.AtCustomerSite)var e="未完成任务"!=this.CompleteState;else this.CompleteState="";if(""==this.address)return this.$refs.uTips.show({title:"地址错误，请刷新",type:"warning",duration:"2300"}),!1;var o={url:"SRClock/Leaving",method:"post",data:{SRCId:this.JCData.SRCId,Address:this.address,Coordinate:this.ZuoBiao,Drag:!this.automatic_manual,Complete:e}};this.$http(o).then((function(e){console.log(e.Data),t.GetSRClocks()})).catch((function(t){console.log(t)}))},reach:function(t){var e=this,o=!1;if("zanting"==t&&(o=!0)," - - "==this.BestMileage)return this.$refs.uTips.show({title:"请等待计算最佳距离！",type:"warning",duration:"2300"}),!1;if(-1!=this.UpdateMileage.indexOf("."))return this.$refs.uTips.show({title:"修改里程禁止输入小数点，请修改",type:"warning",duration:"2300"}),!1;if("到达途中/酒店"==this.radio)var n=1;if("到达客户现场"==this.radio)n=2;if("结束工单"==this.radio)n=3;if("到达家/公司"==this.radio)n=4;var i={url:"SRClock/Arrive",method:"post",data:{SRCId:this.JCData.SRCId,Address:this.address,Coordinate:this.ZuoBiao,Drag:!this.automatic_manual,UpdateMileage:this.UpdateMileage,UpdateReason:this.UpdateReason,DefaultMileage:this.BestMileage,Destination:n,Suspend:o}};console.log(i.data),this.$http(i).then((function(t){console.log(t.Data),e.UpdateMileage="",e.UpdateReason="",e.GetSRClocks()})).catch((function(t){console.log(t)}))},CopyText:function(e){t.setClipboardData({data:e,success:function(e){console.log(e),t.showToast({title:"复制成功",icon:"none"})}})},MergeOrder:function(){this.$store.state.BDSoid=this.JCData.SRCId,t.navigateTo({url:"MergeOrder/MergeOrder"})},UpSaveMemo:function(){var t=this,e={url:"SRClock/SaveMemo",method:"post",data:{SRCId:this.JCData.SRCId,Memo:this.SaveMemo}};this.$http(e).then((function(e){console.log(e.Data),t.GetSRClocks()})).catch((function(t){console.log(t)}))},lookimg:function(e){var o=[e];console.log("查看图片"),t.previewImage({urls:o})},DelImage:function(){var t=this,e={url:"SRClock/DelImage",method:"post",data:{Id:this.delimgid}};this.$http(e).then((function(e){console.log(e.Data),t.GetSRClocks()})).catch((function(t){console.log(t)}))},submit:function(){var e=this,o=[];if(o=this.$refs.uUpload.lists,0==o.length)return this.$refs.uTips.show({title:"请选择图片",type:"warning",duration:"2300"}),!1;t.showLoading({title:"上传中"}),this.loadingState=!0,this.UpimageLength=o.length;for(var i=0;i<o.length;i++)(0,n.pathToBase64)(o[i].url).then((function(t){e.UpimageBase64(t)})).catch((function(t){console.error(t)}))},UpimageBase64:function(e){var o=this,n=this,i={url:"SRClock/UploadImage",method:"post",data:{Id:n.JCData.SRCId,BaseSFStr:e}};n.$uniwebno(i).then((function(e){console.log(e.Data),n.GetSRClocks(),n.UpimageLength-=1,0==n.UpimageLength&&(n.loadingState=!1,o.$refs.uUpload.lists=[],setTimeout((function(){t.hideLoading(),n.GetSRClocks()}),100))})).catch((function(e){n.loadingState=!1,setTimeout((function(){t.hideLoading(),n.GetSRClocks()}),100)}))},getLocation:function(){var e=this;t.getLocation({type:"wgs84",altitude:!1,geocode:!0,success:function(t){console.log(t);var o=t.address;o.province==o.city&&(o.city=""),e.address=o.province+o.city+o.district+o.street+o.streetNum+o.poiName,e.automatic_manual=!0,console.log("当前位置的经度："+t.longitude),console.log("当前位置的纬度："+t.latitude),e.ZuoBiao=t.latitude+","+t.longitude}})},order:function(){console.log("查看详情"),this.$store.state.SRCId=this.JCData.SRCId,t.navigateTo({url:"../home/orderDetails/OKorder"})},ClickMap:function(){var e=this;t.chooseLocation({success:function(t){console.log("位置名称："+t.name),console.log("详细地址："+t.address),console.log("纬度："+t.latitude),console.log("经度："+t.longitude),e.BestMileage=" - - ",e.address=t.address,e.automatic_manual=!1,e.ZuoBiao=t.latitude+","+t.longitude,1==e.JCData.State&&e.$refs.uTips.show({title:"正在重新计算最佳距离！",type:"success",duration:"2300"});var o={url:"SRClock/BestMileage",method:"post",data:{SRCId:e.JCData.SRCId,Coordinate:e.ZuoBiao}};console.log("获取最佳里程"),e.$http(o).then((function(t){console.log(t),e.BestMileage=t.Data,e.$refs.uTips.show({title:"准备完成！请操作！",type:"success",duration:"2300"}),console.log("++++++++++++++++++++++++++++++++++++")})).catch((function(t){console.log(t),console.log("-----------------------------------------")}))}})},GetSRClocks:function(){var e=this,o={url:"SRClock/GetSRClock",method:"get",data:{srcid:this.$store.state.SRCId}};this.$http(o).then((function(o){if(console.log(o),e.indexState=0,null==o.Data)return e.indexState=2,!1;e.JCData={},e.JCData=o.Data,e.checked=e.JCData.Reimbursement,e.SaveMemo=e.JCData.Memo;for(var n=0;n<e.JCData.Details.length;n++){var i=e.JCData.Details[n].CreateDate,a=new Date(i).toJSON();e.JCData.Details[n].CreateDate=new Date(+new Date(a)+288e5).toISOString().replace(/T/g," ").replace(/\.[\d]{3}Z/,"")}var s=e;s.$refs.uTips.show({title:"正在获取当前位置！",type:"success",duration:"2300"}),t.getLocation({type:"wgs84",altitude:!1,geocode:!0,success:function(t){console.log(t);var e=t.address;e.province==e.city&&(e.city=""),s.address=e.province+e.city+e.district+e.street+e.streetNum+e.poiName,s.automatic_manual&&(s.automatic_manual=!0,console.log("当前位置的经度："+t.longitude),console.log("当前位置的纬度："+t.latitude),s.ZuoBiao=t.latitude+","+t.longitude),1==s.JCData.State&&(s.$refs.uTips.show({title:"正在计算最佳距离！",type:"success",duration:"2300"}),s.BestMileageFUN())}})})).catch((function(t){console.log(t)}))},BestMileageFUNCX:function(){var t=this;t.$refs.uTips.show({title:"正在尝试重新获取最佳距离！",type:"success",duration:"2300"});var e={url:"SRClock/BestMileage",method:"post",data:{SRCId:t.JCData.SRCId,Coordinate:t.ZuoBiao}};t.$http(e).then((function(e){t.BestMileage=e.Data,t.$refs.uTips.show({title:"准备完成！请操作！",type:"success",duration:"2300"})})).catch((function(e){t.BestMileageFUN()}))},BestMileageFUN:function(){var t=this,e={url:"SRClock/BestMileage",method:"post",data:{SRCId:t.JCData.SRCId,Coordinate:t.ZuoBiao}};console.log("获取最佳里程"),t.$http(e).then((function(e){t.BestMileage=e.Data,t.$refs.uTips.show({title:"准备完成！请操作！",type:"success",duration:"2300"})})).catch((function(e){if(t.get_angle_similarity+=1,t.get_angle_similarity>5)return t.$refs.uTips.show({title:"最佳距离获取失败，请手动获取",type:"info",duration:"2300"}),!1;t.$refs.uTips.show({title:"最佳距离获取失败，进行第"+t.get_angle_similarity+"次重试",type:"error",duration:"2300"}),t.BestMileageFUN()}))},switchB:function(t){var e=this;if(console.log("报销 清空车牌号"),t){var o={url:"SRClock/UpdateReimbursement",method:"post",data:{SRCId:this.JCData.SRCId,Reimbursement:t,TicketNumber:""}};this.$http(o).then((function(t){console.log(t),console.log("-----------------------------------------"),e.GetSRClocks()})).catch((function(t){console.log(t)}))}},Uploadlicense:function(){var t=this;if(""==this.numberPlate)return this.$refs.uTips.show({title:"请输入车牌号",type:"warning",duration:"2300"}),!1;var e={url:"SRClock/UpdateReimbursement",method:"post",data:{SRCId:this.JCData.SRCId,Reimbursement:!1,TicketNumber:this.numberPlate}};this.$http(e).then((function(e){console.log(e),console.log("-----------------------------------------"),t.numberPlate="",t.GetSRClocks()})).catch((function(t){console.log(t)}))}}};e.default=i}).call(this,o("543d")["default"])},b88e:function(t,e,o){"use strict";o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return a})),o.d(e,"a",(function(){return n}));var n={uModal:function(){return o.e("node-modules/uview-ui/components/u-modal/u-modal").then(o.bind(null,"6188"))},uTopTips:function(){return o.e("node-modules/uview-ui/components/u-top-tips/u-top-tips").then(o.bind(null,"cb86"))},uEmpty:function(){return o.e("node-modules/uview-ui/components/u-empty/u-empty").then(o.bind(null,"1c13"))},uIcon:function(){return o.e("node-modules/uview-ui/components/u-icon/u-icon").then(o.bind(null,"32e8"))},uButton:function(){return o.e("node-modules/uview-ui/components/u-button/u-button").then(o.bind(null,"2311"))},uCellGroup:function(){return o.e("node-modules/uview-ui/components/u-cell-group/u-cell-group").then(o.bind(null,"6288"))},uCellItem:function(){return o.e("node-modules/uview-ui/components/u-cell-item/u-cell-item").then(o.bind(null,"60ac"))},uSwitch:function(){return o.e("node-modules/uview-ui/components/u-switch/u-switch").then(o.bind(null,"8712"))},uInput:function(){return Promise.all([o.e("common/vendor"),o.e("node-modules/uview-ui/components/u-input/u-input")]).then(o.bind(null,"ad91"))},uForm:function(){return o.e("node-modules/uview-ui/components/u-form/u-form").then(o.bind(null,"45e9"))},uFormItem:function(){return Promise.all([o.e("common/vendor"),o.e("node-modules/uview-ui/components/u-form-item/u-form-item")]).then(o.bind(null,"e70c"))},uRadioGroup:function(){return Promise.all([o.e("common/vendor"),o.e("node-modules/uview-ui/components/u-radio-group/u-radio-group")]).then(o.bind(null,"bd71"))},uRadio:function(){return o.e("node-modules/uview-ui/components/u-radio/u-radio").then(o.bind(null,"1dcf"))},uImage:function(){return o.e("node-modules/uview-ui/components/u-image/u-image").then(o.bind(null,"9ad8"))},uUpload:function(){return Promise.all([o.e("common/vendor"),o.e("node-modules/uview-ui/components/u-upload/u-upload")]).then(o.bind(null,"e6a5"))}},i=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e,o){var n=arguments[arguments.length-1].currentTarget.dataset,i=n.eventParams||n["event-params"];o=i.itemimg;t.delimgid=o.ID,t.DelImgshow=!0})},a=[]},c2aa:function(t,e,o){"use strict";(function(t){o("dfeb");n(o("66fd"));var e=n(o("4a1c"));function n(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=o,t(e.default)}).call(this,o("543d")["createPage"])}},[["c2aa","common/runtime","common/vendor"]]]);